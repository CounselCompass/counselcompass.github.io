<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>School Calendar with Countdown & Progress Bar</title>
  <link rel="stylesheet" href="style/calendar.css">
  <link rel="stylesheet" href="style/buttons.css"/>
</head>
<body>
  <header class="header-bar">
    <button class="button-79" id="timetableBtn">Timetable</button>
    <button class="button-79" id="mapBtn">Map</button>
    <button class="button-79" id="calendarBtn">Calendar</button>
    <button class="button-79" id="helpBtn">Help</button>
  </header>

  <div class="container">
    <img src="images/calendar_for_website.jpg" alt="School calendar with academic year dates" />

    <div id="countdown">
      <span class="emoji" role="img" aria-label="Santa">ðŸŽ…</span>
      <span id="countdown-text">Loading countdown...</span>
    </div>

    <div id="progress-container" aria-label="Progress until Christmas Break">
      <div id="progress-bar"></div>
      <div id="progress-text">0%</div>
    </div>
  </div>

  <script>
    function updateCountdown() {
      const countdownText = document.getElementById('countdown-text');
      const progressBar = document.getElementById('progress-bar');
      const progressText = document.getElementById('progress-text');

      const now = new Date();
      const currentYear = now.getUTCFullYear();

      // Target: Dec 20, 1:20 PM GMT
      let targetDate = new Date(Date.UTC(currentYear, 11, 20, 13, 20, 0));
      // Start date for progress bar: Nov 3, 00:00 GMT of current year
      const startDate = new Date(Date.UTC(currentYear, 10, 3, 0, 0, 0)); // Month 10 = Nov

      if (now > targetDate) {
        targetDate = new Date(Date.UTC(currentYear + 1, 11, 20, 13, 20, 0));
      }

      const totalSeconds = Math.floor((targetDate - now) / 1000);
      const days = Math.floor(totalSeconds / 86400);
      const hours = Math.floor((totalSeconds % 86400) / 3600);
      const minutes = Math.floor((totalSeconds % 3600) / 60);
      const seconds = totalSeconds % 60;

      countdownText.textContent =
        `Days until Christmas Break: ${days}d ${hours}h ${minutes}m ${seconds}s`;

      // Calculate progress % based on time elapsed since startDate
      let totalDuration = targetDate - startDate;
      let elapsed = now - startDate;
      let progressPercent = Math.min(Math.max((elapsed / totalDuration) * 100, 0), 100);

      progressBar.style.width = progressPercent + '%';
      progressText.textContent = progressPercent.toFixed(1) + '%';
    }

    updateCountdown();
    setInterval(updateCountdown, 1000);
  </script>

</body>
</html>
